# Kode TUI 架构文档

## 文档列表

- **📋 [overview.md](./overview.md)** - TUI架构总述
  - 总体架构设计
  - 核心架构层级
  - 技术栈和架构特点

- **🧩 [modules.md](./modules.md)** - 模块划分详情
  - 详细模块功能说明
  - 模块依赖关系
  - 扩展点设计

- **📊 [architecture-diagram.md](./architecture-diagram.md)** - 架构图
  - Mermaid语法可视化图表
  - 组件关系、数据流、技术栈图

## 核心架构特点

### 1. 分层架构设计
- **用户界面层**: React + Ink组件系统
- **核心业务层**: 消息处理、样式渲染、主题系统
- **基础设施层**: 终端控制、Hook管理、工具函数

### 2. 模块化设计
- 每个功能都是独立模块
- 清晰的接口和依赖关系
- 易于测试和维护

### 3. 响应式设计
- 自动适应终端尺寸变化
- 全局尺寸状态管理
- 跨组件尺寸同步

### 4. 主题系统
- 支持明暗主题模式
- 色盲友好主题选项
- 语义化颜色定义

### 5. 扩展性设计
- 消息类型可扩展
- 主题配置可扩展
- 交互组件可扩展
- 终端功能可扩展

## 技术栈

- **UI框架**: React + Ink
- **样式渲染**: Marked + cli-highlight + Chalk
- **终端控制**: Node.js stdout/stderr API
- **状态管理**: React Hooks + 全局状态
- **开发语言**: TypeScript

## 开发指南

### 添加新消息类型
1. 在 `src/components/messages/` 创建新组件
2. 在 `AssistantTextMessage` 中添加类型检测
3. 更新类型定义和导入

### 添加新主题
1. 在 `src/utils/theme.ts` 中添加主题配置
2. 更新 `ThemeNames` 类型定义
3. 配置全局主题获取逻辑

### 添加新交互组件
1. 在 `src/components/` 创建新组件
2. 集成到REPL界面的渲染逻辑中
3. 确保主题和尺寸Hook的集成

### 添加终端功能
1. 在 `src/utils/terminal.ts` 中添加新函数
2. 确保跨平台兼容性
3. 提供适当的错误处理

## 架构原则

1. **组件独立性**: 每个组件应该尽可能独立
2. **接口清晰**: 模块间通过明确定义的接口通信
3. **可测试性**: 设计易于测试的模块结构
4. **可维护性**: 代码结构清晰，易于理解和修改
5. **性能优化**: 避免不必要的重渲染和计算

## 相关链接

- [项目总架构文档](../README.md)
- [用户使用指南](../../user-guide/)
- [开发贡献指南](../../CONTRIBUTING.md)

---

*本文档最后更新于: 2024年12月*
*Kode TUI架构版本: 1.0*